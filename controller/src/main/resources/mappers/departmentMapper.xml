<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  

  
  <mapper namespace="departmentMapper">

	<!-- 학과 공지 게시물 리스트 -->
	<select id="list" parameterType="CommunityVO" resultType="CommunityVO">
		Select
				`COMMUNITY_SEQ`, `MINOR_CD`, `COMMUNITY_USER_ID`, `COMMUNITY_TITLE`,
				 `COMMUNITY_CONTENT`, `COMMUNITY_IMG`, `COMMUNITY_USED_PRICE`, 
				 `COMMUNITY_USED_IMG1`, `COMMUNITY_USED_IMG2`, `COMMUNITY_USED_IMG3`,
				  `COMMUNITY_USED_CHEAK`, `COMMUNITY_USED_GROUP`, `COMMUNITY_MEETING_DATE`,
				   substring(`COMMUNITY_WRITE_DATETIME`,1,19) as COMMUNITY_WRITE_DATETIME, `COMMUNITY_REVISE_DATETIME`, `COMMUNITY_LOOKUPCNT`
		From
				community_notice
		<where> 
	        	<choose> 
	        	<when test="searchFiled == ''">minor_cd='DEB001'  AND 1=1 </when> 
	        	<when test="searchFiled == 'community_title'">minor_cd='DEB001'  AND community_title like CONCAT('%', #{searchValue} , '%') </when> 
		    	<when test="searchFiled == 'community_user_id'"> minor_cd='DEB001'  AND community_user_id like CONCAT('%', #{searchValue} , '%')</when>
	        	 </choose>
	  </where>
			order by community_write_datetime desc
		limit #{limitNo},#{pageSize}				
	</select>
	
	<!-- 학과 게시물 카운트 -->
	<select id="list_count" parameterType="CommunityVO" resultType="int">
		Select
				 count(*) as totalCount
		From
				community_notice
		<where> 
	        	<choose> 
	        	<when test="searchFiled == ''">minor_cd='DEB001'  AND 1=1 </when> 
	        	<when test="searchFiled == 'community_title'">minor_cd='DEB001'  AND community_title like CONCAT('%', #{searchValue} , '%') </when> 
		    	<when test="searchFiled == 'community_user_id'"> minor_cd='DEB001'  AND community_user_id like CONCAT('%', #{searchValue} , '%')</when>
	        	 </choose>
	  </where>
	  </select>
	<!-- 학과 공지 보여주기 -->
	<select id="view" parameterType="CommunityVO" resultType="CommunityVO">
		Select
				`COMMUNITY_SEQ`, `MINOR_CD`, `COMMUNITY_USER_ID`, `COMMUNITY_TITLE`,
				 `COMMUNITY_CONTENT`, `COMMUNITY_IMG`, `COMMUNITY_USED_PRICE`, 
				 `COMMUNITY_USED_IMG1`, `COMMUNITY_USED_IMG2`, `COMMUNITY_USED_IMG3`,
				  `COMMUNITY_USED_CHEAK`, `COMMUNITY_USED_GROUP`, `COMMUNITY_MEETING_DATE`,
				   substring(`COMMUNITY_WRITE_DATETIME`,1,19) as COMMUNITY_WRITE_DATETIME, `COMMUNITY_REVISE_DATETIME`, `COMMUNITY_LOOKUPCNT`
				   
		From
				community_notice
		Where community_seq=#{community_seq}
			
	</select>
	
	<insert id="fileInsert" parameterType="CommunityVO">
    <![CDATA[
        INSERT INTO community_notice(minor_cd,community_user_id,community_title,community_content,community_img) 
        VALUES (#{minor_cd},#{community_user_id},#{community_title},#{community_content},#{community_img})
    ]]>
</insert>


<!-- 학과 공지 수정하기 -->
<update id="modify" parameterType="CommunityVO" >
		Update community_notice set community_title=#{community_title},community_content=#{community_content}
		 ,community_img=#{community_img},community_revise_datetime=#{community_revise_datetime}
		Where community_seq=#{community_seq}
		
			
	</update>

	
	<delete id="delete" parameterType="CommunityVO">
	<![CDATA[
		Delete From community_notice where community_seq=#{community_seq}
		]]> 
	</delete>
	 
	
</mapper>